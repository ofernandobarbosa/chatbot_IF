version: "3.1"
session_config:
  session_expiration_time: 60
  carry_over_slots_to_new_session: true

intents:
  - affirm
  - bot_challenge
  - deny
  - goodbye
  - greet
  - request_doc_register
  - request_do_register
  # - request_historic
  - request_email
  - request_classes
  - request_calendar:
      ignore_entities:
        - PER
  - request_courses
  - request_redo_register
  - inform_name:
      ignore_entities:
        - LOC
  - inform_professor_name:
      ignore_entities:
        - LOC
  - ask_what_bot_do
  - modality
  - courses
  - ingress_modality

entities:
  - PER
  - LOC
  - register
  - classes
  - calendar
  - courses
  - documents
  - courses_modality
  - courses_name
  - courses_link
  - ingress_modality
  - request_redo_register

slots:
  # teste validar nome
  name:
    type: text
    influence_conversation: true
    mappings:
      - type: from_entity
        intent: inform_name
        entity: PER
        and:
          - not_intent: inform_professor_name
          - not_intent: greet
        conditions:
          - active_loop: name_form
            requested_slot: name
  professor_name:
    type: text
    influence_conversation: true
    mappings:
      - type: from_entity
        entity: PER
        intent: inform_professor_name
        not_intent: inform_name
        conditions:
          - active_loop: professor_name_form
            requested_slot: professor_name
  classes:
    type: text
    mappings:
      - type: from_entity
        entity: classes
        conditions:
          - active_loop: classes_form
  calendar:
    type: text
    mappings:
      - type: from_entity
        entity: calendar
        conditions:
          - active_loop: calendar_form

  #forms action get course
  courses_name:
    type: text
    mappings:
      - type: from_entity
        entity: courses_name
  courses_modality:
    type: text
    mappings:
      - type: from_entity
        entity: courses_modality
  courses_link:
    type: text
    mappings:
      - type: from_entity
        entity: courses_link

  documents:
    type: text
    mappings:
      - type: from_entity
        entity: documents
        conditions:
          - active_loop: documents_form

  ingress_modality:
    type: text
    mappings:
      - type: from_entity
        entity: ingress_modality

forms:
  name_form:
    ignored_intents:
      - greet
      - inform_professor_name
    required_slots:
      - name
  professor_name_form:
    ignored_intents:
      - greet
      - inform_name
    required_slots:
      - professor_name
  classes_form:
    required_slots:
      - classes
  calendar_form:
    required_slots:
      - calendar
  courses_form:
    required_slots:
      - courses_modality
  documents_form:
    required_slots:
      - documents

responses:
  utter_greet:
    - text: Eai, seja bem-vindo :)
    - text: Olá, seja bem-vindo :)
  utter_examples:
    - text: Me pergunte o que faço para ver algumas opções
  utter_ask_name:
    - text: Qual é seu nome?
    - text: Me informa seu nome?
  utter_ask_professor_name:
    - text: Qual o nome do professor?
    - text: Me informa o nome do professor?
  utter_ask_help:
    - text: Em que posso ajudar {name}?
  utter_goodbye:
    - text: Até logo, {name}! :)
  utter_iamabot:
    - text: I am a bot, powered by Rasa.
  utter_ask_classes:
    - text: Os horários de suas aulas e disciplinas você pode conferir aqui!
  utter_ask_calendar:
    - text: Confira aqui seu calendário acadêmico!
  utter_ask_courses:
    - text: Os cursos disponíveis no IFRS campus Rio Grande pode ser visualizados aqui!
  utter_ask_documents:
    - text: Estes são os documentos que você precisa manter atualizados no IFRS = CPF, Comprovante de residência e dados cadastrais!
  utter_req_to_ask:
    - text: Pode dizer ou então me pergunte o que posso fazer!

  # utter buttons
  utter_ask_more_help:
    - buttons:
        - payload: /affirm
          title: Sim
        - payload: /deny
          title: Não
      button_type: inline
      text: Gostaria de mais alguma ajuda?
  utter_ask_courses_modality:
    - text: Para qual modalidade gostaria de informações?
      buttons:
        - title: Técnicos integrados
          payload: '/modality{{"courses_modality":"integrado"}}'
        - title: Técnicos subsequente
          payload: '/modality{{"courses_modality":"subsequente"}}'
        - title: Superiores
          payload: '/modality{{"courses_modality":"superior"}}'
      button_type: vertical
  utter_ask_ingress_modality:
    - text: Qual a forma de ingresso?
      buttons:
        - title: Enem
          payload: '/ingress_modality{{"ingress_modality":"Enem"}}'
        - title: Processo seletivo EJA
          payload: '/ingress_modality{{"ingress_modality":"Processo seletivo EJA"}}'
        - title: Prova
          payload: '/ingress_modality{{"ingress_modality":"Prova"}}'
        - title: PS indígena
          payload: '/ingress_modality{{"ingress_modality":"PS indígena"}}'
        - title: Sorteio
          payload: '/ingress_modality{{"ingress_modality":"Sorteio"}}'
      button_type: vertical
  utter_ask_redo_register:
    - text: Qual a modalidade do curso que você quer fazer a rematrícula? 
      buttons:
        - title: Técnicos integrados
          payload: '/modality{{"courses_modality":"integrado"}}'
        - title: Técnicos subsequente
          payload: '/modality{{"courses_modality":"subsequente"}}'
        - title: Superiores
          payload: '/modality{{"courses_modality":"superior"}}'
      button_type: vertical

actions:
  - utter_ask_help
  - utter_goodbye
  - utter_greet
  - utter_ask_classes
  - utter_ask_calendar
  - utter_ask_courses
  - utter_ask_documents

  # custom actions
  - action_get_professor_contact
  - action_get_doc_register
  - action_get_classes
  - action_get_calendar
  - action_get_courses
  - action_get_info_course
  - action_inform_do_register
  - action_inform_redo_register
  - action_system_type
  - action_what_bot_do
  - action_goodbye_and_clear_slots

  # custom validation
  - validate_name_form
  - validate_professor_name_form
